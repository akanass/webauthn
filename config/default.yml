server:
  protocol: http
  host: 0.0.0.0
  port: 3000
  isSSL: false
  options:
    logger: true
views:
  templatesPath: ../views
  layout: _layout
  includeViewExtension: true
  engineOptions:
    async: true
    htmlMinifierOptions:
      removeComments: true
      removeCommentsFromCDATA: true
      collapseWhitespace: true
      collapseBooleanAttributes: true
      removeEmptyAttributes: true
      minifyCSS: true
      minifyJS: true
  defaultContext:
    title: Fido2 WebAuthn + OpenID Connect
assets:
  rootPath: ../public
  options:
    prefix: /public/
    cacheControl: true
    etag: true
    acceptRanges: true
    lastModified: true
    maxAge: 86400000
pipes:
  validation:
    whitelist: true
    forbidNonWhitelisted: true

rollup:
  app:
    input:
      - static/ts/login.ts
    output:
      - dir: public/js
        format: es
        entryFileNames: '[format]/[name]-[hash].min.mjs'
        chunkFileNames: '[format]/[name]-[hash].min.mjs'
      - dir: public/js
        format: system
        entryFileNames: '[format]/[name]-[hash].min.js'
        chunkFileNames: '[format]/[name]-[hash].min.js'
  vendor:
    input: static/js/vendor.js
    output:
      dir: public/js
      format: iife
      entryFileNames: '[name]-[hash].min.js'
  scss:
    input: static/scss/style.scss
    output:
      dir: public/css
      assetFileNames: '[name]-[hash][extname]'
  options:
    scss:
      mode: extract
      sass:
        impl: sass
        fibers: false
        sync: true
      minimize: true
    clear:
      js:
        targets: public/js/**/*.{js,mjs}
      css:
        before:
          targets: public/css/*
        after:
          targets: public/css/*.js
          hook: writeBundle
    typescript:
      tsconfig: tsconfig.browser.json
    nodeResolve:
      mainFields:
        - jsnext:main
        - module
        - main
