import{_ as t}from"./tslib.es6-1ebb5d3a.min.mjs";import{m as n}from"./map-c50a29b4.min.mjs";import{s as i,f as e}from"./from-4d24ed45.min.mjs";import{S as o,O as r}from"./Observable-6ae2b1d1.min.mjs";var s=function(n){function i(t){var i=n.call(this)||this;return i.parent=t,i}return t(i,n),i.prototype._next=function(t){this.parent.notifyNext(t)},i.prototype._error=function(t){this.parent.notifyError(t),this.unsubscribe()},i.prototype._complete=function(){this.parent.notifyComplete(),this.unsubscribe()},i}(o),u=function(n){function i(){return null!==n&&n.apply(this,arguments)||this}return t(i,n),i.prototype.notifyNext=function(t){this.destination.next(t)},i.prototype.notifyError=function(t){this.destination.error(t)},i.prototype.notifyComplete=function(){this.destination.complete()},i}(o);function c(t,i,o){return void 0===o&&(o=Number.POSITIVE_INFINITY),"function"==typeof i?function(r){return r.pipe(c((function(o,r){return e(t(o,r)).pipe(n((function(t,n){return i(o,t,r,n)})))}),o))}:("number"==typeof i&&(o=i),function(n){return n.lift(new p(t,o))})}var p=function(){function t(t,n){void 0===n&&(n=Number.POSITIVE_INFINITY),this.project=t,this.concurrent=n}return t.prototype.call=function(t,n){return n.subscribe(new f(t,this.project,this.concurrent))},t}(),f=function(n){function e(t,i,e){void 0===e&&(e=Number.POSITIVE_INFINITY);var o=n.call(this,t)||this;return o.project=i,o.concurrent=e,o.hasCompleted=!1,o.buffer=[],o.active=0,o.index=0,o}return t(e,n),e.prototype._next=function(t){this.active<this.concurrent?this._tryNext(t):this.buffer.push(t)},e.prototype._tryNext=function(t){var n,i=this.index++;try{n=this.project(t,i)}catch(t){return void this.destination.error(t)}this.active++,this._innerSub(n)},e.prototype._innerSub=function(t){var n=new s(this),e=this.destination;e.add(n);var o=function(t,n){if(!n.closed)return t instanceof r?t.subscribe(n):i(t)(n)}(t,n);o!==n&&e.add(o)},e.prototype._complete=function(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()},e.prototype.notifyNext=function(t){this.destination.next(t)},e.prototype.notifyComplete=function(){var t=this.buffer;this.active--,t.length>0?this._next(t.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()},e}(u);export{c as m};
