import{a as t}from"./tslib.es6-ba244ae5.min.mjs";import{b as e,S as r}from"./map-d5847e52.min.mjs";import{m as i}from"./mergeMap-e9e2eaae.min.mjs";function s(){}var o=function(){function t(t,e,r){this.nextOrObserver=t,this.error=e,this.complete=r}return t.prototype.call=function(t,e){return e.subscribe(new a(t,this.nextOrObserver,this.error,this.complete))},t}(),a=function(r){function i(t,i,o,a){var n=r.call(this,t)||this;return n._tapNext=s,n._tapError=s,n._tapComplete=s,n._tapError=o||s,n._tapComplete=a||s,e(i)?(n._context=n,n._tapNext=i):i&&(n._context=i,n._tapNext=i.next||s,n._tapError=i.error||s,n._tapComplete=i.complete||s),n}return t(i,r),i.prototype._next=function(t){try{this._tapNext.call(this._context,t)}catch(t){return void this.destination.error(t)}this.destination.next(t)},i.prototype._error=function(t){try{this._tapError.call(this._context,t)}catch(t){return void this.destination.error(t)}this.destination.error(t)},i.prototype._complete=function(){try{this._tapComplete.call(this._context)}catch(t){return void this.destination.error(t)}return this.destination.complete()},i}(r);const n=document.querySelector("#error-authenticators-list"),c=document.querySelector("#error-authenticators-list-message"),l=document.querySelector("#error-webauthn-message"),d=document.querySelector("#authenticators-tab-bar"),u=document.querySelector("#security-keys"),m=document.querySelector("#security-keys-list"),p=document.querySelector("#biometrics"),h=document.querySelector("#biometrics-list"),y=document.querySelector("#add-security-key"),b=document.querySelector("#add-biometric");let v;window.addEventListener("load",(()=>{L()}));const _=()=>{n.style.display="none",c.style.display="none",c.innerText="",l.style.display="none"},f=t=>{n.style.display="flex",c.style.display="inline",c.innerText=t,l.style.display="none"},x=t=>b.disabled=t,S=t=>y.disabled=t,q=t=>{x(t),S(t)},L=()=>{_(),q(!0),v&&v.unsubscribe(),import("./_api-4237f916.min.mjs").then((({api:t})=>{var e,r,s;v=t.loggedIn().pipe((e=t=>t,function(t){return t.lift(new o(e,r,s))}),i((e=>t.getCredentialsList(e.userId)))).subscribe((t=>{v.unsubscribe(),w(t),d.addEventListener("MDCTabBar:activated",(t=>{switch(_(),t.detail.index){case 0:u.classList.add("authenticators-list--active"),p.classList.remove("authenticators-list--active");break;case 1:u.classList.remove("authenticators-list--active"),p.classList.add("authenticators-list--active");break;default:u.classList.remove("authenticators-list--active"),p.classList.remove("authenticators-list--active"),f("Authenticators list can't be displayed")}})),S(!1)}),(t=>E(t,v)))}))},g=(t,e)=>{import("./_template-b2df9bb2.min.mjs").then((({template:r})=>t.innerHTML=r.generateCredentialsList(e)))},w=t=>{g(m,t.securityKeys),g(h,t.biometrics),x(!t.addBiometricsButtonIsEnabled),setTimeout((()=>{[].map.call(document.querySelectorAll(".edit-authenticator"),(t=>{t.addEventListener("click",(()=>{var e;_();const r=null===(e=t.dataset)||void 0===e?void 0:e.authenticatorid;console.log(r)}))}))}),100)},E=(t,e,r)=>{if(401===t.status)e&&e.unsubscribe(),window.location.href="/error";else{const e=[].concat(t.message).shift();f(e);const i=!!r&&void 0!==r.add,s=!!r&&void 0!==r.edit;(i||s)&&setTimeout((()=>{var t;i&&q(!r.add),s&&(t=!r.edit,[].map.call(document.querySelectorAll(".edit-authenticator"),(e=>e.disabled=t)))}),500)}};
